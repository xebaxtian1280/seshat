"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5060],{30548:function(e,t,n){var r=n(18381),i=n(51541),o=n(25309),s=n(40878),a=n(87113),l=n(23986),u=n(29810),h=n(38808),c=n(16235),p=n(61341),x=n(88292),d=n(30470),_=n(28487);const g="extentchanged";class v extends r.Ay{constructor(e){super(g),this.extent=e}}class w extends a.A{constructor(e){super(e=e||{}),this.on,this.once,this.un,this.condition_=e.condition?e.condition:h.Gk,this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),this.extentOverlay_=new l.A({source:new u.A({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:E(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new l.A({source:new u.A({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:f(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)}snapToVertex_(e,t){const n=t.getCoordinateFromPixelInternal(e),r=function(e,t){return(0,p.$x)(n,e)-(0,p.$x)(n,t)},i=this.getExtentInternal();if(i){const o=function(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}(i);o.sort(r);const s=o[0];let a=(0,p.sG)(n,s);const l=t.getPixelFromCoordinateInternal(a);if((0,p.Io)(e,l)<=this.pixelTolerance_){const e=t.getPixelFromCoordinateInternal(s[0]),n=t.getPixelFromCoordinateInternal(s[1]),r=(0,p.hG)(l,e),i=(0,p.hG)(l,n),o=Math.sqrt(Math.min(r,i));return this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(a=r>i?s[1]:s[0]),a}}return null}handlePointerMove_(e){const t=e.pixel,n=e.map;let r=this.snapToVertex_(t,n);r||(r=n.getCoordinateFromPixelInternal(t)),this.createOrUpdatePointerFeature_(r)}createOrUpdateExtentFeature_(e){let t=this.extentFeature_;return t?e?t.setGeometry((0,d.VY)(e)):t.setGeometry(void 0):(t=e?new i.A((0,d.VY)(e)):new i.A({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t}createOrUpdatePointerFeature_(e){let t=this.vertexFeature_;if(t){t.getGeometry().setCoordinates(e)}else t=new i.A(new s.A(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t);return t}handleEvent(e){return!e.originalEvent||!this.condition_(e)||(e.type!=o.A.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),super.handleEvent(e),!1)}handleDownEvent(e){const t=e.pixel,n=e.map,r=this.getExtentInternal();let i=this.snapToVertex_(t,n);const o=function(e){let t=null,n=null;return e[0]==r[0]?t=r[2]:e[0]==r[2]&&(t=r[0]),e[1]==r[1]?n=r[3]:e[1]==r[3]&&(n=r[1]),null!==t&&null!==n?[t,n]:null};if(i&&r){const e=i[0]==r[0]||i[0]==r[2]?i[0]:null,t=i[1]==r[1]||i[1]==r[3]?i[1]:null;null!==e&&null!==t?this.pointerHandler_=y(o(i)):null!==e?this.pointerHandler_=F(o([e,r[1]]),o([e,r[3]])):null!==t&&(this.pointerHandler_=F(o([r[0],t]),o([r[2],t])))}else i=n.getCoordinateFromPixelInternal(t),this.setExtent([i[0],i[1],i[0],i[1]]),this.pointerHandler_=y(i);return!0}handleDragEvent(e){if(this.pointerHandler_){const t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}}handleUpEvent(e){this.pointerHandler_=null;const t=this.getExtentInternal();return t&&0!==(0,c.UG)(t)||this.setExtent(null),!1}setMap(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),super.setMap(e)}getExtent(){return(0,_.JR)(this.getExtentInternal(),this.getMap().getView().getProjection())}getExtentInternal(){return this.extent_}setExtent(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new v(this.extent_))}}function E(){const e=(0,x.mY)();return function(t,n){return e.Polygon}}function f(){const e=(0,x.mY)();return function(t,n){return e.Point}}function y(e){return function(t){return(0,c.Tr)([e,t])}}function F(e,t){return e[0]==t[0]?function(n){return(0,c.Tr)([e,[n[0],t[1]]])}:e[1]==t[1]?function(n){return(0,c.Tr)([e,[t[0],n[1]]])}:null}var m=w,I=n(41564),A=n(28e3),P=n(12185),T=n(87240);const O=new I.A({layers:[new P.A({source:new A.A})],target:"map",view:new T.Ay({center:[0,0],zoom:2})}),M=new m({condition:h.Kg});O.addInteraction(M)}},function(e){var t;t=30548,e(e.s=t)}]);
//# sourceMappingURL=extent-interaction.js.map