{"version":3,"file":"filter-points-webgl.js","mappings":"iMAUA,MAAMA,EAAe,IAAI,IAAO,CAC9BC,aAAc,SAMVC,EAAY,CAChB,IACA,CACE,IACA,CACE,IACA,CACE,IACA,CAAC,QACD,CAAC,cAAe,CAAC,UAAW,CAAC,MAAO,QAAS,KAAM,EAAG,KAV/C,aAgBb,IAGIC,EAAQ,CACZC,UAAW,CACTC,QAAS,KACTC,QAAS,MAEXC,OAAQ,CAAC,UAAW,CAAC,MAAO,QAAS,CAAC,MAAO,WAAY,CAAC,MAAO,YACjE,gBAAiB,CACf,IACA,CAAC,cAAe,CAAC,UAAW,CAAC,MAAO,QAAS,EAAG,EAAG,IAAQ,IAC3D,CAAC,IAAK,KAAM,CAAC,IAAKL,EAAW,OAE/B,oBAAqB,CACnB,cACA,CAAC,UACDA,EACA,EAnCa,UAqCb,EAtCa,wBAyCf,iBAAkB,CAAC,IAAK,EAAK,CAAC,IAAKA,EAAW,OAI1CM,EAAeC,SAASC,eAAe,YACvCC,EAAeF,SAASC,eAAe,YAE7C,SAASE,IACP,MAAMC,EAAMJ,SAASC,eAAe,UACpCG,EAAIC,cAAc,iBAAiBC,YAAcP,EAAaQ,MAC9DH,EAAIC,cAAc,iBAAiBC,YAAcJ,EAAaK,KAChE,CAEAR,EAAaS,iBAAiB,SAAS,WACrCd,EAAMC,UAAUC,QAAUa,SAASV,EAAaQ,OAChDJ,GACF,IACAD,EAAaM,iBAAiB,SAAS,WACrCd,EAAMC,UAAUE,QAAUY,SAASP,EAAaK,OAChDJ,GACF,IACAA,IAGA,MAAMO,EAAS,IAAIC,eACnBD,EAAOE,KAAK,MAAO,mCACnBF,EAAOG,OAAS,WACd,MAAMC,EAAMJ,EAAOK,aACbC,EAAW,GAEjB,IAEIC,EAFAC,EAAYJ,EAAIK,QAAQ,MAAQ,EAGpC,MAAqD,IAA7CF,EAAWH,EAAIK,QAAQ,KAAMD,KAAmB,CACtD,MAAME,EAAON,EAAIO,OAAOH,EAAWD,EAAWC,GAAWI,MAAM,KAC/DJ,EAAYD,EAAW,EAEvB,MAAMM,GAAS,QAAW,CAACC,WAAWJ,EAAK,IAAKI,WAAWJ,EAAK,MAC5DK,MAAMF,EAAO,KAAOE,MAAMF,EAAO,KAKrCP,EAASU,KACP,IAAI,IAAQ,CACVC,KAAMH,WAAWJ,EAAK,KAAO,EAC7BQ,KAAMnB,SAASW,EAAK,KAAO,EAC3BS,SAAU,IAAI,IAAMN,KAG1B,CAEAhC,EAAauC,YAAYd,EAC3B,EACAN,EAAOqB,OAEP,MAAMC,EAAM,IAAI,IAAI,CAClBC,OAAQ,CACN,IAAI,IAAU,CACZC,OAAQ,IAAI,IAAW,CACrBC,MAAO,mBAGX,IAAI,IAAiB,CACnBzC,MAAOA,EACPwC,OAAQ3C,EACR6C,qBAAqB,KAGzBC,OAAQrC,SAASC,eAAe,OAChCqC,KAAM,IAAI,KAAK,CACbC,OAAQ,CAAC,EAAG,GACZC,KAAM,OAKV,SAASC,IACPT,EAAIU,SACJC,OAAOC,sBAAsBH,EAC/B,CACAA,E","sources":["webpack:///./filter-points-webgl.js"],"sourcesContent":["import Feature from '../src/ol/Feature.js';\nimport Map from '../src/ol/Map.js';\nimport Point from '../src/ol/geom/Point.js';\nimport StadiaMaps from '../src/ol/source/StadiaMaps.js';\nimport TileLayer from '../src/ol/layer/Tile.js';\nimport View from '../src/ol/View.js';\nimport WebGLPointsLayer from '../src/ol/layer/WebGLPoints.js';\nimport {Vector} from '../src/ol/source.js';\nimport {fromLonLat} from '../src/ol/proj.js';\n\nconst vectorSource = new Vector({\n  attributions: 'NASA',\n});\n\nconst oldColor = 'rgba(242,56,22,0.61)';\nconst newColor = '#ffe52c';\nconst period = 12; // animation period in seconds\nconst animRatio = [\n  '^',\n  [\n    '/',\n    [\n      '%',\n      [\n        '+',\n        ['time'],\n        ['interpolate', ['linear'], ['get', 'year'], 1850, 0, 2015, period],\n      ],\n      period,\n    ],\n    period,\n  ],\n  0.5,\n];\n\nconst style = {\n  variables: {\n    minYear: 1850,\n    maxYear: 2015,\n  },\n  filter: ['between', ['get', 'year'], ['var', 'minYear'], ['var', 'maxYear']],\n  'circle-radius': [\n    '*',\n    ['interpolate', ['linear'], ['get', 'mass'], 0, 4, 200000, 13],\n    ['-', 1.75, ['*', animRatio, 0.75]],\n  ],\n  'circle-fill-color': [\n    'interpolate',\n    ['linear'],\n    animRatio,\n    0,\n    newColor,\n    1,\n    oldColor,\n  ],\n  'circle-opacity': ['-', 1.0, ['*', animRatio, 0.75]],\n};\n\n// handle input values & events\nconst minYearInput = document.getElementById('min-year');\nconst maxYearInput = document.getElementById('max-year');\n\nfunction updateStatusText() {\n  const div = document.getElementById('status');\n  div.querySelector('span.min-year').textContent = minYearInput.value;\n  div.querySelector('span.max-year').textContent = maxYearInput.value;\n}\n\nminYearInput.addEventListener('input', function () {\n  style.variables.minYear = parseInt(minYearInput.value);\n  updateStatusText();\n});\nmaxYearInput.addEventListener('input', function () {\n  style.variables.maxYear = parseInt(maxYearInput.value);\n  updateStatusText();\n});\nupdateStatusText();\n\n// load data;\nconst client = new XMLHttpRequest();\nclient.open('GET', 'data/csv/meteorite_landings.csv');\nclient.onload = function () {\n  const csv = client.responseText;\n  const features = [];\n\n  let prevIndex = csv.indexOf('\\n') + 1; // scan past the header line\n\n  let curIndex;\n  while ((curIndex = csv.indexOf('\\n', prevIndex)) != -1) {\n    const line = csv.substr(prevIndex, curIndex - prevIndex).split(',');\n    prevIndex = curIndex + 1;\n\n    const coords = fromLonLat([parseFloat(line[4]), parseFloat(line[3])]);\n    if (isNaN(coords[0]) || isNaN(coords[1])) {\n      // guard against bad data\n      continue;\n    }\n\n    features.push(\n      new Feature({\n        mass: parseFloat(line[1]) || 0,\n        year: parseInt(line[2]) || 0,\n        geometry: new Point(coords),\n      }),\n    );\n  }\n\n  vectorSource.addFeatures(features);\n};\nclient.send();\n\nconst map = new Map({\n  layers: [\n    new TileLayer({\n      source: new StadiaMaps({\n        layer: 'stamen_toner',\n      }),\n    }),\n    new WebGLPointsLayer({\n      style: style,\n      source: vectorSource,\n      disableHitDetection: true,\n    }),\n  ],\n  target: document.getElementById('map'),\n  view: new View({\n    center: [0, 0],\n    zoom: 2,\n  }),\n});\n\n// animate the map\nfunction animate() {\n  map.render();\n  window.requestAnimationFrame(animate);\n}\nanimate();\n"],"names":["vectorSource","attributions","animRatio","style","variables","minYear","maxYear","filter","minYearInput","document","getElementById","maxYearInput","updateStatusText","div","querySelector","textContent","value","addEventListener","parseInt","client","XMLHttpRequest","open","onload","csv","responseText","features","curIndex","prevIndex","indexOf","line","substr","split","coords","parseFloat","isNaN","push","mass","year","geometry","addFeatures","send","map","layers","source","layer","disableHitDetection","target","view","center","zoom","animate","render","window","requestAnimationFrame"],"sourceRoot":""}